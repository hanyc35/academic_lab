<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>科研数据库 - 注册</title>
    <script src="tailwind.css"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36CFC9',
                        tertiary: '#722ED1',
                        neutral: {
                            100: '#F5F7FA',
                            200: '#E4E6EB',
                            300: '#C9CDD4',
                            700: '#4E5969',
                            800: '#272E3B',
                            900: '#1D2129',
                        }
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .input-focus {
                @apply focus:ring-2 focus:ring-primary/50 focus:border-primary transition-all duration-300;
            }
            .tag-active {
                @apply bg-primary text-white;
            }
            .tag-inactive {
                @apply bg-neutral-200 text-neutral-700 hover:bg-neutral-300 transition-colors duration-200;
            }
            .progress-step {
                @apply relative flex flex-col items-center;
            }
            .progress-line {
                @apply absolute h-1 w-full top-1/2 -translate-y-1/2 z-0;
            }
            .progress-dot {
                @apply relative z-10 flex items-center justify-center w-8 h-8 rounded-full border-2 transition-all duration-300;
            }
            .progress-label {
                @apply mt-2 text-xs font-medium text-center;
            }
        }
    </style>
</head>
<body class="font-inter bg-neutral-100 min-h-screen flex items-center justify-center">
    <div class="container mx-auto px-4 py-12">
        <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden">
            <!-- 顶部进度条 -->
            <div class="border-b border-neutral-200">
                <div class="flex items-center">
                    <div class="w-full flex justify-between py-6 px-8">
                        <div class="progress-step">
                            <div class="progress-line bg-primary"></div>
                            <div class="progress-dot bg-primary text-white">1</div>
                            <div class="progress-label text-primary">账号信息</div>
                        </div>
                        <div class="progress-step">
                            <div class="progress-line bg-primary"></div>
                            <div class="progress-dot bg-primary text-white">2</div>
                            <div class="progress-label text-primary">领域选择</div>
                        </div>
                        <div class="progress-step">
                            <div class="progress-line bg-neutral-200"></div>
                            <div class="progress-dot bg-neutral-200 text-neutral-400">3</div>
                            <div class="progress-label text-neutral-400">完成注册</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 注册表单 -->
            <div class="p-8 md:p-12">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-neutral-900 mb-2">选择研究领域</h2>
                    <p class="text-neutral-600">选择您感兴趣的研究领域，以便我们为您推荐合适的科研资源</p>
                </div>

                <form class="space-y-6">
                    <!-- 领域分类标题 -->
                    <div>
                        <h3 class="text-lg font-semibold text-neutral-800 mb-4 flex items-center">
                            <i class="fas fa-book-open text-primary mr-2"></i>
                            主要研究领域
                        </h3>
                    </div>

                    <!-- 领域选择标签（包含"其他"选项） -->
                    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3">
                        <button type="button" class="tag-btn tag-inactive px-4 py-2 rounded-full text-sm font-medium" data-field="tax-finance">财税</button>
                        <button type="button" class="tag-btn tag-inactive px-4 py-2 rounded-full text-sm font-medium" data-field="economics">经济</button>
                        <button type="button" class="tag-btn tag-inactive px-4 py-2 rounded-full text-sm font-medium" data-field="business">商科</button>
                        <button type="button" class="tag-btn tag-inactive px-4 py-2 rounded-full text-sm font-medium" data-field="management">工商管理</button>
                        <button type="button" class="tag-btn tag-inactive px-4 py-2 rounded-full text-sm font-medium" data-field="finance">金融</button>
                        <button type="button" class="tag-btn tag-inactive px-4 py-2 rounded-full text-sm font-medium" data-field="accounting">会计</button>
                        <button type="button" class="tag-btn tag-inactive px-4 py-2 rounded-full text-sm font-medium" data-field="statistics">统计</button>
                        <button type="button" class="tag-btn tag-inactive px-4 py-2 rounded-full text-sm font-medium" data-field="law">经济法学</button>
                        <button type="button" class="tag-btn tag-inactive px-4 py-2 rounded-full text-sm font-medium" data-field="trade">国际贸易</button>
                        <button type="button" class="tag-btn tag-inactive px-4 py-2 rounded-full text-sm font-medium" data-field="marketing">市场营销</button>
                        <!-- 新增"其他"领域按钮 -->
                        <button type="button" class="tag-btn tag-inactive px-4 py-2 rounded-full text-sm font-medium" data-field="other">其他</button>
                    </div>

                    <!-- 其他领域输入 -->
                    <div id="otherFieldContainer" class="mt-6 hidden">
                        <label for="otherField" class="block text-sm font-medium text-neutral-700 mb-2">
                            其他研究领域 (请详细说明)
                        </label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="fas fa-pen text-neutral-400"></i>
                            </div>
                            <input type="text" id="otherField" name="otherField" class="block w-full pl-12 pr-4 py-3 border border-neutral-300 rounded-lg input-focus" placeholder="例如：行为经济学、绿色金融等">
                        </div>
                    </div>

                    <!-- 已选择领域预览 -->
                    <div>
                        <h3 class="text-lg font-semibold text-neutral-800 mb-3 flex items-center">
                            <i class="fas fa-list-check text-secondary mr-2"></i>
                            已选择的领域
                        </h3>
                        <div id="selectedFieldsContainer" class="flex flex-wrap gap-2 p-3 bg-neutral-50 rounded-lg min-h-[40px]">
                            <p class="text-neutral-500 text-sm">点击上方标签选择领域</p>
                        </div>
                    </div>

                    <!-- 下一步按钮 -->
                    <div class="pt-4">
                        <a href="注册界面3.html" type="button" id="nextStep" class="w-full flex justify-center py-3 px-6 border border-transparent rounded-lg shadow-md text-base font-medium text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                            下一步
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // 领域标签选择逻辑
        const tagButtons = document.querySelectorAll('.tag-btn');
        const selectedFieldsContainer = document.getElementById('selectedFieldsContainer');
        const otherFieldContainer = document.getElementById('otherFieldContainer');
        const otherFieldInput = document.getElementById('otherField');
        const nextButton = document.getElementById('nextStep');
        const selectedFields = new Set();

        // 标签点击事件
        tagButtons.forEach(button => {
            button.addEventListener('click', function() {
                const field = this.dataset.field;
                const fieldName = this.textContent;
                
                // 切换选中状态
                if (selectedFields.has(field)) {
                    selectedFields.delete(field);
                    this.classList.remove('tag-active');
                    this.classList.add('tag-inactive');
                } else {
                    selectedFields.add(field);
                    this.classList.remove('tag-inactive');
                    this.classList.add('tag-active');
                }
                
                // 处理"其他"选项
                if (field === 'other') {
                    otherFieldContainer.classList.remove('hidden');
                    otherFieldInput.focus();
                } else {
                    if (selectedFields.has('other') && !otherFieldInput.value.trim()) {
                        selectedFields.delete('other');
                    }
                    otherFieldContainer.classList.add('hidden');
                }
                
                updateSelectedFieldsDisplay();
                checkNextButtonValidity();
            });
        });

        // 其他领域输入事件
        otherFieldInput.addEventListener('input', function() {
            const value = this.value.trim();
            if (value) {
                selectedFields.add('other');
                updateSelectedFieldsDisplay();
                checkNextButtonValidity();
            } else if (selectedFields.has('other')) {
                selectedFields.delete('other');
                updateSelectedFieldsDisplay();
                checkNextButtonValidity();
            }
        });

        // 更新已选择领域显示
        function updateSelectedFieldsDisplay() {
            if (selectedFields.size === 0) {
                selectedFieldsContainer.innerHTML = '<p class="text-neutral-500 text-sm">点击上方标签选择领域</p>';
                return;
            }
            
            selectedFieldsContainer.innerHTML = '';
            selectedFields.forEach(field => {
                if (field === 'other' && otherFieldInput.value.trim()) {
                    const tag = document.createElement('span');
                    tag.className = 'flex items-center bg-neutral-200 text-neutral-700 px-3 py-1 rounded-full text-sm';
                    tag.textContent = otherFieldInput.value.trim();
                    selectedFieldsContainer.appendChild(tag);
                } else {
                    const fieldNames = {
                        'tax-finance': '财税',
                        'economics': '经济',
                        'business': '商科',
                        'management': '工商管理',
                        'finance': '金融',
                        'accounting': '会计',
                        'statistics': '统计',
                        'law': '经济法学',
                        'trade': '国际贸易',
                        'marketing': '市场营销',
                        'other': otherFieldInput.value.trim() || '其他领域'
                    };
                    
                    const tag = document.createElement('span');
                    tag.className = 'flex items-center bg-primary text-white px-3 py-1 rounded-full text-sm';
                    tag.textContent = fieldNames[field] || field;
                    
                    // 添加删除按钮
                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'ml-1 text-white/70 hover:text-white';
                    deleteBtn.innerHTML = '<i class="fas fa-times text-xs"></i>';
                    deleteBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        selectedFields.delete(field);
                        if (field === 'other') {
                            otherFieldInput.value = '';
                            otherFieldContainer.classList.add('hidden');
                        } else {
                            const btn = document.querySelector(`.tag-btn[data-field="${field}"]`);
                            btn.classList.remove('tag-active');
                            btn.classList.add('tag-inactive');
                        }
                        updateSelectedFieldsDisplay();
                        checkNextButtonValidity();
                    });
                    
                    tag.appendChild(deleteBtn);
                    selectedFieldsContainer.appendChild(tag);
                }
            });
        }

        // 检查下一步按钮有效性
        function checkNextButtonValidity() {
            nextButton.disabled = selectedFields.size === 0;
        }

        // 下一步按钮点击事件（实际应用中应替换为表单提交或页面跳转）
        nextButton.addEventListener('click', function() {
            // 收集选择的领域
            const fields = Array.from(selectedFields).map(field => {
                if (field === 'other' && otherFieldInput.value.trim()) {
                    return otherFieldInput.value.trim();
                }
                const fieldNames = {
                    'tax-finance': '财税',
                    'economics': '经济',
                    'business': '商科',
                    'management': '工商管理',
                    'finance': '金融',
                    'accounting': '会计',
                    'statistics': '统计',
                    'law': '经济法学',
                    'trade': '国际贸易',
                    'marketing': '市场营销'
                };
                return fieldNames[field] || field;
            });
            
            // 模拟表单提交，实际应跳转到完成注册页面
            alert(`已选择领域: ${fields.join(', ')}\n跳转到完成注册页面`);
            // window.location.href = 'register-step3.html';
        });
    </script>
</body>
</html>